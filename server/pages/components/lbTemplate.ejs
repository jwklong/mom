<link rel="stylesheet" href="/static/style.css">
<%- include('header') %>

<%
    let sort = columns.find(v => v.name == query.category)?.sort || columns.find(v => v.name == defaultSort).sort
    let sortedItems = baseData.sort(sort)
%>

<div class="content">
    <h1><%- title %></h1>
    <% try { %>
        <p><%- subtext %></p>
    <% } catch {} %>
    <br>
    <table>
        <thead>
            <tr>
                <% for (let column of columns.filter(v => v.visible !== false)) { %>
                    <% if (column.sort) { %>
                        <th><a href="?category=<%= column.name %>"><%- column.name %></a></th>
                    <% } else { %>
                        <th><%- column.name %></th>
                    <% } %>
                <% } %>
            </tr>
        </thead>
        <tbody>
            <% for (let item of sortedItems) { %>
                <tr>
                    <% for (let column of columns.filter(v => v.visible !== false)) { %>
                        <td><%- column.value(item) %></td>
                    <% } %>
                </tr>
            <% } %>
            <% if (sortedItems.length == 0) { %>
                <tr>
                    <td colspan="100">no data yet</td>
                </tr>
            <% } %>
        </tbody>
    </table>
</div>